# Интегрированная система управления зарядными станциями ESP32

## Обзор интеграции

Данный проект объединяет современный веб интерфейс системы управления зарядными станциями из папки `projectz` с ESP32 проектом в папке `projectone`.

## Структура проекта

```
projectone/
├── main/
│   ├── main.c                          # Основной C код ESP32
│   ├── charging_station_handlers.c     # Обработчики API зарядных станций
│   ├── charging_station_handlers.h     # Заголовочный файл обработчиков
│   ├── charging-station.html          # Главная страница веб интерфейса
│   ├── charging-station.css           # Стили интерфейса
│   ├── charging-station.js            # JavaScript логика
│   ├── master_slave_logic.c           # Логика master/slave плат
│   ├── udp_comm.c                     # UDP коммуникация
│   └── CMakeLists.txt                 # Конфигурация сборки
├── client/                            # React веб приложение (из projectz)
├── server/                            # Express сервер (из projectz)
└── shared/                            # Общие схемы данных (из projectz)
```

## Интегрированные компоненты

### 1. Веб интерфейс ESP32
- **Файл**: `charging-station.html`
- **Функционал**: Современный интерфейс управления зарядными станциями
- **Возможности**:
  - Дашборд с плитками станций
  - Сканирование и подключение ESP32 плат
  - Управление параметрами станций
  - Переключение светлой/темной темы
  - Автоматическое обновление данных

### 2. API обработчики C
- **Файл**: `charging_station_handlers.c`
- **Маршруты**:
  - `GET /charging-station` - Главная страница
  - `GET /charging-station.css` - Стили
  - `GET /charging-station.js` - JavaScript
  - `GET /api/stations` - Список станций
  - `PATCH /api/stations/{id}` - Обновление станции
  - `POST /api/esp32/scan` - Сканирование плат
  - `POST /api/esp32/connect` - Подключение к плате

### 3. React приложение
- **Папка**: `client/`
- **Компоненты**: Полнофункциональный React интерфейс из projectz
- **Интеграция**: Может работать параллельно с ESP32 интерфейсом

### 4. Express сервер
- **Папка**: `server/`
- **API**: REST API для управления зарядными станциями
- **Хранилище**: JSON файлы для персистентности данных

## Функциональность

### Веб интерфейс ESP32
1. **Дашборд станций**
   - Отображение статуса станций в реальном времени
   - Мониторинг мощности и типа станций
   - Быстрый доступ к управлению

2. **Подключение плат**
   - Автоматическое сканирование сети для поиска ESP32
   - Ручное подключение по IP адресу
   - Отображение найденных устройств

3. **Управление станцией**
   - Настройка основных параметров
   - Управление статусом зарядки
   - Сохранение и сброс настроек

### API функциональность
- **JSON API**: Полноценный REST API с поддержкой CORS
- **Валидация данных**: Проверка входящих JSON данных
- **Логирование**: Подробные логи всех операций
- **Автоответы**: Структурированные JSON ответы

## Технические особенности

### ESP32 интеграция
- Встроенные файлы в прошивку через CMake
- Минимальное использование памяти
- Поддержка HTTPS и HTTP
- mDNS для обнаружения устройств

### Веб технологии
- Современный CSS с поддержкой темной темы
- JavaScript ES6+ с классами
- Адаптивный дизайн для мобильных устройств
- Автоматическое обновление данных

### Совместимость
- Работает как на ESP32, так и в браузере
- Единый API для обеих версий
- Совместимые схемы данных
- Одинаковый пользовательский опыт

## Сборка и развертывание

### ESP32 версия
```bash
cd projectone
idf.py build
idf.py flash monitor
```

### React версия
```bash
cd projectone
npm install
npm run dev
```

## Доступ к интерфейсам

1. **ESP32 веб интерфейс**: `http://[ESP32_IP]/charging-station`
2. **React приложение**: `http://localhost:5000`
3. **API документация**: Доступна через оба интерфейса

## Конфигурация

### Настройки ESP32
- WiFi параметры в `sdkconfig`
- Сетевые настройки в `config.json`
- Master/Slave конфигурация

### Настройки сервера
- Порт сервера: 5000
- База данных: JSON файлы в папке `data/`
- CORS: Разрешены все источники

## Безопасность

- HTTPS поддержка на ESP32
- Валидация входных данных
- Защита от XSS атак
- Безопасные заголовки HTTP

Интеграция завершена успешно. Оба интерфейса работают независимо и предоставляют одинаковую функциональность управления зарядными станциями.